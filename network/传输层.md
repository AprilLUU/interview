## 传输层

提供不同主机进程到进程之间的逻辑通信

复用，应用层中不同进程的数据都可以使用同一个传输层协议传输数据

分用，接收方接收到传输层数据后交付给应用层不同的进程

差错检测，对报文进行差错检测，检测出错则将报文丢弃

#### UDP

无连接服务，传输数据前不需要建立连接，只会将报文段直接放到网络上进行传输，并尽可能送达目的主机，接收方收到报文段之后也不需要给予确认，属于不可靠传输。

面向报文，首部开销小，时延小，不需要建立连接，不需要确认机制，没有重传机制和计时器，没有流量和拥塞控制，适用于传输小文件以及即时通信。

#### TCP

面向连接，需要先建立连接再进行数据传输，传输结束后需要释放连接。

不提供广播或多播服务，属于端到端的通信，可靠传输。

需要增加许多开销，首部开销，缓存，重传和计时器，连接管理等，时延大，适合传输大文件和需要可靠传输数据。

可靠传输，保证数据无差错，有序，不重复，不丢失。

全双工通信，发送方和接收方都可以互发数据，都需要有发送和接收缓存，存储接收的数据和发送的数据。

TCP建立连接三次握手

1. 客户端向服务器端发送请求连接报文（SYN=1,ACK=0,seq=x）
2. 服务端为该TCP连接分配缓存和变量，并向客户端发送同意建立连接报文（SYN=1,ACK=1,seq=y,ack=x+1）
3. 客户端为该TCP连接分配缓存和变量，并向服务器端发送确认的确认报文，此时可以携带数据（捎带确认）

TCP释放连接四次挥手

​	1.客户端向服务端发送终止连接请求（FIN=1,seq=u）

​	2.服务端向客户端发送确认释放连接报文（ACK=1,seq=v，ack=u+1），此时客户端不能再向服务器端发送数据，服务器端仍可以发送数据给客户端，TCP连接处于半关闭。

​	3.服务端向客户端发送释放连接请求（FIN=1,seq=w）

​	4.客户端发送确认报文（ACK=1,seq=u+1，ack=w+1），客户端等待2MSL（最长报文段寿命比2倍RTT稍长，防止确认报文丢失，服务器重新发送释放连接请求时可以重传确认报文）后，TCP连接释放。

